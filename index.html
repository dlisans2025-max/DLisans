<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DLisans</title>
<style>
body, html { margin:0; padding:0; font-family: Arial, sans-serif; background:#f0f2f5; }
header { display:flex; align-items:center; justify-content:center; background:#0078d7; padding:10px 20px; color:white; position: fixed; top:0; width:100%; z-index:1000; }
#logo-text { font-size:36px; font-weight:bold; }
#cart-btn { position:absolute; right:50px; font-size:20px; cursor:pointer; background:white; color:#0078d7; padding:6px 12px; border-radius:8px; display:none; }
#logout-btn { position:absolute; right:200px; top:10px; background:#ff4444; color:white; padding:6px 12px; border:none; border-radius:8px; cursor:pointer; display:none; }
.main { margin-top:100px; max-width:1000px; margin-left:auto; margin-right:auto; padding:20px; }
.auth-container { position: fixed; top:0; left:0; width:100%; height:100%; display:flex; justify-content:center; align-items:center; background: linear-gradient(135deg,#4facfe,#00f2fe); z-index:999; }
.auth-box { background:white; padding:40px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.2); width:90%; max-width:400px; text-align:center; }
.auth-box h2 { color:#0078d7; margin-bottom:25px; }
.auth-box button { width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; margin-top:10px; cursor:pointer; font-weight:bold; }
#google-btn { background:#db4437; color:white; }
.products { display:flex; flex-wrap:wrap; gap:20px; }
.product { background:white; border-radius:15px; padding:20px; width:calc(33.333% - 20px); box-shadow:0 10px 20px rgba(0,0,0,0.1); transition:.3s; cursor:pointer; }
.product:hover { transform:translateY(-5px) scale(1.02); box-shadow:0 15px 25px rgba(0,0,0,0.2); }
.product img { width:100%; border-radius:12px; }
.product h3 { margin-top:10px; }
.product-info { margin-top:10px; white-space:pre-line; text-align:left; }
.btn { display:inline-block; background:#25d366; color:white; padding:10px 20px; border-radius:8px; text-decoration:none; font-weight:bold; transition:.3s; margin-top:10px; border:none; cursor:pointer; }
.btn:hover { background:#20b954; transform:scale(1.05); }
.admin-panel { background:#e2e8f0; padding:20px; border-radius:15px; margin-bottom:20px; display:none; }
.admin-panel h3 { margin-top:0; }
.admin-panel input, .admin-panel button { margin:5px 0; padding:8px; border-radius:6px; border:1px solid #ccc; }
footer { text-align:center; padding:15px; color:white; background:#0078d7; margin-top:40px; }
</style>
</head>
<body>
<header>
  <div id="logo-text">DLisans</div>
  <div id="cart-btn">ðŸ›’ SÉ™bÉ™t</div>
  <button id="logout-btn" onclick="logout()">Ã‡Ä±xÄ±ÅŸ</button>
</header>

<div class="auth-container" id="auth-container">
  <div class="auth-box">
    <h2>Google ilÉ™ daxil ol</h2>
    <button id="google-btn" onclick="googleLogin()">Google ilÉ™ daxil ol</button>
  </div>
</div>

<div class="main" id="home">
  <div class="admin-panel" id="admin-panel">
    <h3>Admin Paneli</h3>
    <input type="text" id="product-name" placeholder="MÉ™hsul adÄ±">
    <input type="text" id="product-price" placeholder="MÉ™hsul qiymÉ™ti">
    <input type="text" id="product-desc" placeholder="MÉ™hsul tÉ™sviri">
    <input type="text" id="product-img" placeholder="MÉ™hsul ÅŸÉ™kil linki">
    <button onclick="addProduct()">MÉ™hsul É™lavÉ™ et</button>
  </div>
  <div class="products" id="products"></div>
</div>

<footer>
  <div>Email: <b>dlisans2025@gmail.com</b></div>
  <div>Â© 2025 DLisans | BÃ¼tÃ¼n hÃ¼quqlar qorunur.</div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAV2gxee4c4RZNvgqb1ID4ehCi5ZtckgCs",
  authDomain: "dlisans.firebaseapp.com",
  projectId: "dlisans",
  storageBucket: "dlisans.appspot.com",
  messagingSenderId: "671873538369",
  appId: "1:671873538369:web:ffbb94792ab7b805a0e9c0",
  measurementId: "G-Q9CGH70JSL"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();
const db = getFirestore(app);

let isAdmin = false;

function renderProducts(products) {
  const productsContainer = document.getElementById("products");
  productsContainer.innerHTML = "";
  products.forEach((p) => {
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <img src="${p.img}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>${p.price} AZN</p>
      <div class="product-info">${p.desc}</div>
      ${isAdmin ? `<button class="btn" style="background:#ff4444;" onclick="deleteProduct('${p.id}')">MÉ™hsulu sil</button>` : ""}
    `;
    productsContainer.appendChild(div);
  });
}

function loadProducts() {
  const productsCol = collection(db, "products");
  onSnapshot(productsCol, (snapshot) => {
    const products = [];
    snapshot.forEach((doc) => {
      products.push({ id: doc.id, ...doc.data() });
    });
    renderProducts(products);
  });
}

async function addProduct() {
  const name = document.getElementById("product-name").value;
  const price = document.getElementById("product-price").value;
  const desc = document.getElementById("product-desc").value;
  const img = document.getElementById("product-img").value;
  if (!name || !price || !desc || !img) { alert("BÃ¼tÃ¼n sahÉ™lÉ™ri doldurun!"); return; }
  await addDoc(collection(db, "products"), { name, price, desc, img });
}

async function deleteProduct(id) {
  await deleteDoc(doc(db, "products", id));
}

function googleLogin() {
  signInWithPopup(auth, provider).then((result) => {
    const user = result.user;
    document.getElementById("auth-container").style.display = "none";
    document.getElementById("cart-btn").style.display = "block";
    document.getElementById("logout-btn").style.display = "block";
    if (user.email === "dlisans2025@gmail.com") {
      document.getElementById("admin-panel").style.display = "block";
      isAdmin = true;
    }
    loadProducts();
  }).catch(console.error);
}

function logout() {
  signOut(auth).then(() => {
    document.getElementById("auth-container").style.display = "flex";
    document.getElementById("cart-btn").style.display = "none";
    document.getElementById("logout-btn").style.display = "none";
    document.getElementById("admin-panel").style.display = "none";
    isAdmin = false;
  });
}

loadProducts();
</script>
</body>
</html>
