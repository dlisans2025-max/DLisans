<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DLisans Admin Panel</title>
<link rel="icon" type="image/jpeg" href="https://i.postimg.cc/JGxxt6cV/Whats-App-Image-2025-09-27-at-03-12-23-b84d530b.jpg">
<style>
body, html { margin:0; padding:0; font-family: Arial, sans-serif; background:#f0f2f5; }
header { display:flex; align-items:center; justify-content:center; background:#0078d7; padding:10px 20px; color:white; position: fixed; top:0; width:100%; z-index:1000; box-shadow:0 3px 10px rgba(0,0,0,0.2);}
#logo-text { font-size:36px; font-weight:bold; }
#cart-btn { position:absolute; right:50px; font-size:20px; cursor:pointer; background:white; color:#0078d7; padding:6px 12px; border-radius:8px; font-weight:bold; display:none; }
#logout-btn { position:absolute; right:200px; top:10px; background:#ff4444; color:white; padding:6px 12px; border:none; border-radius:8px; cursor:pointer; display:none; }
.main { margin-top:100px; max-width:1000px; margin-left:auto; margin-right:auto; padding:20px; }
.auth-container { position: fixed; top:0; left:0; width:100%; height:100%; display:flex; justify-content:center; align-items:center; background: linear-gradient(135deg,#4facfe,#00f2fe); z-index:999; }
.auth-box { background:white; padding:40px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.2); width:90%; max-width:400px; text-align:center; }
.auth-box h2 { color:#0078d7; margin-bottom:25px; }
.auth-box button { width:100%; padding:12px; border:none; border-radius:8px; font-size:16px; margin-top:10px; cursor:pointer; font-weight:bold; }
#google-btn { background:#db4437; color:white; }
#google-btn:hover { background:#c23328; transform:scale(1.03); }
.error { color:red; margin-top:10px; font-size:14px; }
.success { color:green; margin-top:10px; font-size:14px; }
.products { display:flex; flex-wrap:wrap; gap:20px; }
.product { background:white; border-radius:15px; padding:20px; width:calc(33.333% - 20px); box-shadow:0 10px 20px rgba(0,0,0,0.1); transition:.3s; cursor:pointer; }
.product:hover { transform:translateY(-5px) scale(1.02); box-shadow:0 15px 25px rgba(0,0,0,0.2); }
.product img { width:100%; border-radius:12px; }
.product h3 { margin-top:10px; }
.product-info { margin-top:10px; white-space:pre-line; text-align:left; }
.btn { display:inline-block; background:#25d366; color:white; padding:10px 20px; border-radius:8px; text-decoration:none; font-weight:bold; transition:.3s; margin-top:10px; border:none; cursor:pointer; }
.btn:hover { background:#20b954; transform:scale(1.05); }
footer { text-align:center; padding:15px; color:white; background:#0078d7; margin-top:40px; display:flex; flex-direction:column; gap:5px; }
#cart-modal { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:20px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.3); display:none; width:90%; max-width:400px; z-index:2000; }
.cart-item { display:flex; justify-content:space-between; margin-bottom:10px; border-bottom:1px solid #ddd; padding-bottom:5px; align-items:center; }
.cart-controls button { margin:0 3px; padding:2px 6px; cursor:pointer; border:none; border-radius:4px; }
#close-cart { background:#f44336; color:white; border:none; padding:5px 10px; cursor:pointer; border-radius:5px; margin-top:10px; }
#order-btn { background:#25d366; color:white; border:none; padding:10px 15px; cursor:pointer; border-radius:8px; margin-top:10px; font-weight:bold; width:100%; }
#order-btn:hover { background:#20b954; }
.admin-panel { background:#e2e8f0; padding:20px; border-radius:15px; margin-bottom:20px; }
.admin-panel h3 { margin-top:0; }
.admin-panel input, .admin-panel button { margin:5px 0; padding:8px; border-radius:6px; border:1px solid #ccc; }
@media (max-width:768px){ .product { width:100% !important; } }
</style>
</head>
<body>
<header>
  <div id="logo-text">DLisans</div>
  <div id="cart-btn" onclick="toggleCart()">üõí S…ôb…ôt <span id="cart-count">0</span></div>
  <button id="logout-btn" onclick="logout()">√áƒ±xƒ±≈ü</button>
</header>

<div class="auth-container" id="auth-container">
  <div class="auth-box">
    <h2>Google il…ô daxil ol</h2>
    <button id="google-btn" onclick="googleLogin()">Google il…ô daxil ol</button>
    <p class="error" id="login-error"></p>
    <p class="success" id="login-success"></p>
  </div>
</div>

<div class="main" id="home">
  <div class="admin-panel" id="admin-panel" style="display:none;">
    <h3>Admin Paneli</h3>
    <label>M…ôhsul adƒ±:</label><input type="text" id="product-name">
    <label>M…ôhsul qiym…ôti:</label><input type="text" id="product-price">
    <label>M…ôhsul t…ôsviri:</label><input type="text" id="product-desc">
    <label>M…ôhsul ≈ü…ôkil linki (URL):</label><input type="text" id="product-img">
    <button onclick="addProduct()">M…ôhsul …ôlav…ô et</button>
  </div>
  <div class="products" id="products"></div>
</div>

<div id="cart-modal">
  <h2>S…ôb…ôt</h2>
  <div id="cart-items"></div>
  <button id="order-btn" onclick="orderCart()">Sifari≈ü et</button>
  <button id="close-cart" onclick="toggleCart()">Baƒüla</button>
</div>

<footer>
  <div>Email: <b>dlisans2025@gmail.com</b></div>
  <div>¬© 2025 DLisans | B√ºt√ºn h√ºquqlar qorunur.</div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyAV2gxee4c4RZNvgqb1ID4ehCi5ZtckgCs",
  authDomain: "dlisans.firebaseapp.com",
  projectId: "dlisans",
  storageBucket: "dlisans.appspot.com",
  messagingSenderId: "671873538369",
  appId: "1:671873538369:web:ffbb94792ab7b805a0e9c0",
  measurementId: "G-Q9CGH70JSL"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

let currentUser = JSON.parse(localStorage.getItem("currentUser") || "null");
let isAdmin = false;
if(currentUser){
  document.getElementById("auth-container").style.display="none";
  document.getElementById("cart-btn").style.display="block";
  document.getElementById("logout-btn").style.display="block";
  if(currentUser.email === "dlisans2025@gmail.com"){
    document.getElementById("admin-panel").style.display="block";
    isAdmin = true;
  }
}

let products = JSON.parse(localStorage.getItem("products")||"[]");
if(products.length===0){
  products = [
    { name: "Windows 11 Pro", price: "30", img: "https://i.postimg.cc/3xqHjz6J/windows11.jpg", desc: "Orijinal Microsoft Windows 11 Pro lisenziyasƒ±" },
    { name: "Office 365", price: "25", img: "https://i.postimg.cc/xC7nKdnk/office365.jpg", desc: "1 illik Office 365 abun…ôliyi" }
  ];
}
const productsContainer = document.getElementById("products");
let editingIndex = null;

function renderProducts() {
  productsContainer.innerHTML = "";
  products.forEach((p,idx) => {
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <img src="${p.img}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>${p.price} AZN</p>
      <div class="product-info">${p.desc}</div>
      <button class="btn" onclick="addToCart('${p.name}','${p.price}')">S…ôb…ôt…ô …ôlav…ô et</button>
      ${isAdmin ? `<button class="btn" style="background:#ff4444;" onclick="deleteProduct(${idx})">M…ôhsulu sil</button>
      <button class="btn" style="background:#0078d7;" onclick="editProduct(${idx})">Redakt…ô et</button>` : ''}
    `;
    productsContainer.appendChild(div);
  });
}
renderProducts();

let cart = JSON.parse(localStorage.getItem("cart")||"[]");
document.getElementById("cart-count").innerText=cart.length;

window.addToCart = (name, price) => { 
  const existing = cart.find(i=>i.name===name);
  if(existing){ existing.qty++; }
  else{ cart.push({name, price, qty:1}); }
  localStorage.setItem("cart", JSON.stringify(cart));
  document.getElementById("cart-count").innerText=cart.length;
}

window.toggleCart = () => { 
  const modal=document.getElementById("cart-modal"); 
  modal.style.display=modal.style.display==="block"?"none":"block"; 
  const items=document.getElementById("cart-items"); 
  items.innerHTML=""; 
  cart.forEach((i,idx)=>{
    items.innerHTML+=`
      <div class="cart-item">
        <span>${i.name} (${i.qty}) - ${i.price} AZN</span>
        <div class="cart-controls">
          <button onclick="changeQty(${idx}, -1)">‚ûñ</button>
          <button onclick="changeQty(${idx}, 1)">‚ûï</button>
          <button onclick="removeFromCart(${idx})">‚ùå</button>
        </div>
      </div>` 
  });
}

window.changeQty = (idx, change) => {
  cart[idx].qty += change;
  if(cart[idx].qty <= 0) cart.splice(idx,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  document.getElementById("cart-count").innerText=cart.length;
  toggleCart(); toggleCart();
}

window.removeFromCart = (idx) => {
  cart.splice(idx,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  document.getElementById("cart-count").innerText=cart.length;
  toggleCart(); toggleCart();
}

window.addProduct = () => {
  const name = document.getElementById("product-name").value;
  const price = document.getElementById("product-price").value;
  const desc = document.getElementById("product-desc").value;
  const img = document.getElementById("product-img").value;
  if(!name || !price || !desc || !img) return alert("B√ºt√ºn sah…ôl…ôri doldurun!");
  try { new URL(img) } catch { return alert("≈û…ôkil linki d√ºzg√ºn URL olmalƒ±dƒ±r!"); }
  if(editingIndex !== null){
    products[editingIndex] = {name, price, desc, img};
    editingIndex = null;
  } else {
    products.push({name, price, desc, img});
  }
  localStorage.setItem("products", JSON.stringify(products));
  renderProducts();
}

window.deleteProduct = (idx) => {
  if(confirm("Bu m…ôhsulu silm…ôk ist…ôyirsiniz?")){
    products.splice(idx,1);
    localStorage.setItem("products", JSON.stringify(products));
    renderProducts();
  }
}

window.editProduct = (idx) => {
  const p = products[idx];
  document.getElementById("product-name").value = p.name;
  document.getElementById("product-price").value = p.price;
  document.getElementById("product-desc").value = p.desc;
  document.getElementById("product-img").value = p.img;
  editingIndex = idx;
  alert("Redakt…ô rejimi a√ßƒ±ldƒ±! M…ôhsulu d…ôyi≈üdikd…ôn sonra 'M…ôhsul …ôlav…ô et' d√ºym…ôsin…ô basƒ±n.");
}

window.googleLogin = () => {
  signInWithPopup(auth, provider).then((result) => {
    const user = result.user;
    localStorage.setItem("currentUser", JSON.stringify({email:user.email}));
    document.getElementById("auth-container").style.display="none";
    document.getElementById("cart-btn").style.display="block";
    document.getElementById("logout-btn").style.display="block";
    if(user.email === "dlisans2025@gmail.com"){
      document.getElementById("admin-panel").style.display="block";
      isAdmin = true;
    }
    renderProducts();
  }).catch(e => { console.log(e); });
}

window.logout = () => {
  signOut(auth).then(()=>{ 
    localStorage.removeItem("currentUser");
    document.getElementById("auth-container").style.display="flex";
    document.getElementById("cart-btn").style.display="none";
    document.getElementById("logout-btn").style.display="none";
    document.getElementById("admin-panel").style.display="none";
    isAdmin = false;
  });
}

window.orderCart = () => {
  if(cart.length===0){ alert("S…ôb…ôt bo≈üdur!"); return; }
  let text = "Salam, m…ôn sifari≈ü etm…ôk ist…ôyir…ôm:%0A";
  cart.forEach((i,idx)=>{ text+=`${idx+1}. ${i.name} (${i.qty}) - ${i.price} AZN%0A` });
  const url = `https://wa.me/994555566828?text=${text}`;
  window.open(url,"_blank");
}
</script>
</body>
</html>
